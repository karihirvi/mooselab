if(NOT DEFINED INSTALL_ROOT OR NOT DEFINED BUILD_DIR)
  message("INSTALL_ROOT and BUILD_DIR must be defined")
  message(FATAL_ERROR)
endif()

if(DEFINED WIN32)
  IF(NOT DEFINED DEBUG OR NOT DEFINED RELEASE)
    message("DEBUG, RELEASE must be defined")
    message(FATAL_ERROR)
  endif()
endif()

file(MAKE_DIRECTORY ${INSTALL_ROOT}/lib)
#file(MAKE_DIRECTORY ${INSTALL_ROOT}/include/gtest)
if(DEFINED WIN32)  
  message("Installing (win)")
  file(MAKE_DIRECTORY ${DEBUG}/tmp)
  file(COPY ${DEBUG}/gtest.lib ${DEBUG}/gtest_main.lib DESTINATION ${DEBUG}/tmp)
  file(RENAME ${DEBUG}/tmp/gtest.lib ${DEBUG}/tmp/gtestd.lib)
  file(RENAME ${DEBUG}/tmp/gtest_main.lib ${DEBUG}/tmp/gtest_maind.lib)
  file(INSTALL ${DEBUG}/tmp/gtestd.lib ${DEBUG}/tmp/gtest_maind.lib DESTINATION ${INSTALL_ROOT}/lib)
  file(INSTALL ${RELEASE}/gtest.lib ${RELEASE}/gtest_main.lib DESTINATION ${INSTALL_ROOT}/lib)
  file(INSTALL ${BUILD_DIR}/../gtest-build/include/gtest  DESTINATION ${INSTALL_ROOT}/include PATTERN *.h)
elseif(DEFINED UNIX)
  message("Installing (linux)")
  file(INSTALL libgtest.a libgtest_main.a DESTINATION ${INSTALL_ROOT}/lib)
  file(INSTALL ${BUILD_DIR}/../gtest-build/include/gtest  DESTINATION ${INSTALL_ROOT}/include PATTERN *.h)  
else()
  message("Unknown OS")
  message(FATAL_ERROR)
endif()